"""
This is a echo bot.
It echoes any incoming text messages.
"""
import json
import logging

from aiogram import Bot, Dispatcher, executor, types

from btns import main_page_button
from configs import BOT_TOKEN
from utils import get_or_create_user, upload_updates_to_server

API_TOKEN = BOT_TOKEN


# Configure logging
logging.basicConfig(level=logging.INFO)

# Initialize bot and dispatcher
bot = Bot(token=API_TOKEN)
dp = Dispatcher(bot)


@dp.message_handler(commands=['start', 'help'])
async def send_welcome(message: types.Message):
    await get_or_create_user(tg_id=message.from_user.id,
                             username=message.from_user.username,
                             first_name=message.from_user.first_name,
                             last_name=message.from_user.last_name)
    text = ("ONEPAGE.kz\n"
            "*–ß—Ç–æ –º—ã —Å–¥–µ–ª–∞–µ–º –¥–ª—è –í–∞—à–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞*\n"
            " 1 –ü—Ä–æ–≤–µ–¥–µ–º –∞—É–¥–∏—Ç –≤–∞—à–µ–π –Ω–∏—à–∏.\n"
            " 2 –û–ø—Ä–µ–¥–µ–ª–∏–º –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤.\n"
            " 3 –û–ø—Ä–µ–¥–µ–ª–∏–º —Ü–µ–ª–µ–≤—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é.\n"
            " 4 –ü—Ä–µ–¥–ª–æ–∂–∏–º –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –ø–ª–∞–Ω –¥–ª—è –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å–∞.\n"
            " 5 –†–∞–∑—Ä–∞–±–æ—Ç–∞–µ–º —Å–∞–π—Ç.\n"
            " 6 –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ–º –æ—Ç–¥–µ–ª –ø—Ä–æ–¥–∞–∂–∏ –≤–Ω–µ–¥—Ä–∏–º CRM —Å–∏—Å—Ç–µ–º—É.\n"
            " 7 –û–±—É—á–∏–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –æ—Ç–¥–µ–ª–∞ –ø—Ä–æ–¥–∞–∂–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è CRM —Å–∏—Å—Ç–µ–º–æ–π.\n"
            " 8 –ù–∞—Å—Ç—Ä–æ–∏–º —Ä–µ–∫–ª–∞–º—É –≤ –ò–Ω—Ç–µ—Ä–Ω–µ—Ç.\n"
            " 9 –û–±–µ—Å–ø–µ—á–∏–º –ø–æ—Ç–æ–∫ –∫–ª–∏–µ–Ω—Ç–æ–≤. –£–≤–µ–ª–∏—á–∏–º –ø—Ä–æ–¥–∞–∂–∏.")

    keyboard_markup = types.InlineKeyboardMarkup(row_width=1)
    text_and_data = (
        ('–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å–∞–π—Ç–∞', 'sites'),
        ('SEO –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è', 'seos'),
        ('–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞', 'contexts'),
        ('–û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É', 'application'),
    )
    row_btns = (types.InlineKeyboardButton(text, callback_data=data) for text, data in text_and_data)
    # keyboard_markup.row(*row_btns)
    for row in row_btns:
        keyboard_markup.row(row)
    keyboard_markup.add(
        # url buttons have no callback data
        types.InlineKeyboardButton('–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç', url='https://onepage.kz'),
    )
    await message.answer_photo(photo=types.InputFile("media/logo3.png"), caption=text, parse_mode="Markdown",
                               reply_markup=keyboard_markup)


@dp.message_handler()
async def echo(message: types.Message):
    result = json.loads(message.as_json())
    await upload_updates_to_server(tg_id=message.from_user.id, json=result)
    await message.answer(message.text)


@dp.callback_query_handler(text='main_page')
async def main_page_query_handler(query: types.CallbackQuery):
    await query.answer("–°–∞–π—Ç—ã")
    await send_welcome(query.message)


@dp.callback_query_handler(text='sites')
async def site_query_handler(query: types.CallbackQuery):
    await query.answer("–°–∞–π—Ç—ã")
    text = ("–†–µ—à–∏–ª–∏ –Ω–∞—á–∞—Ç—å —Å–≤–æ–π –±–∏–∑–Ω–µ—Å –∏–ª–∏ –≤–¥–æ—Ö–Ω—É—Ç—å –Ω–æ–≤—É—é –∂–∏–∑–Ω—å –≤ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∫–æ–º–ø–∞–Ω–∏—é "
            "–∏ –Ω–µ –∑–Ω–∞–µ—Ç–µ —Å —á–µ–≥–æ –Ω–∞—á–∞—Ç—å? –†–µ—à–µ–Ω–∏–µ –µ—Å—Ç—å. –î–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–µ –¥–µ–ª–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É. "
            "–°–∞—Ä–∞—Ñ–∞–Ω–Ω–æ–µ —Ä–∞–¥–∏–æ –∏ —Ö–æ—Ä–æ—à—É—é —Ä–µ–ø—É—Ç–∞—Ü–∏—é, –∫–æ–Ω–µ—á–Ω–æ, –Ω–∏–∫—Ç–æ –Ω–µ –æ—Ç–º–µ–Ω—è–ª, "
            "–Ω–æ –Ω–æ–≤—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø—Ä–∏—Ö–æ–¥—è—Ç –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. ")
    text2 = ("*–ú—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–µ–º –¥–ª—è –≤–∞—Å*\n"
             "ü™™ –°–∞–π—Ç –≤–∏–∑–∏—Ç–∫–∞\n"
             "üõç –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –º–∞–≥–∞–∑–∏–Ω\n"
             "üßæ –°–∞–π—Ç –∫–∞—Ç–∞–ª–æ–≥\n"
             "üõ¨ Landing Page")
    await query.message.answer_photo(photo=types.InputFile('media/sites.jpg'), caption=text)
    await query.message.answer(text2, reply_markup=main_page_button(), parse_mode="Markdown")


@dp.callback_query_handler(text='seos')
async def seos_query_handler(query: types.CallbackQuery):
    await query.answer("SEO")
    text = ("–ß—Ç–æ —Ç–∞–∫–æ–µ SEO –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –∏ —á—Ç–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ–±—ã –Ω–µ –Ω–∞–≤—Ä–µ–¥–∏—Ç—å "
            "–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –º–∏—Ä–µ —É–∑–Ω–∞—é—Ç –æ —Ç–æ–≤–∞—Ä–µ –∏–ª–∏ —É—Å–ª—É–≥–µ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. "
            "–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–∏–≤–ª–µ—á—å –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ –∫–ª–∏–µ–Ω—Ç–æ–≤, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ç–∞–∫–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç "
            "–∫–∞–∫ SEO –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è. ")
    text2 = ("SEO –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è\n"
             "–≠—Ç–∞–ø—ã —Ä–∞–±–æ—Ç—ã –Ω–∞–¥–æ SEO –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π —Å–∞–π—Ç–∞\n"
             "1 - –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∞–π—Ç–∞\n"
             "2 - –Ω–∞–ø–∏—Å–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤ –ø–æ–¥ SEO\n"
             "3 - –≤–Ω–µ—à–Ω—è—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∞–π—Ç–∞ \n\n"
             "   –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ SEO\n"
             "‚ûï –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞\n"
             "‚ûï –ù–µ—Ç –¥–µ–Ω–µ–≥, –µ—Å—Ç—å —Ç—Ä–∞—Ñ–∏–∫\n"
             "‚ûï –î–æ–≤–µ—Ä–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤\n"
             "‚ûï –í –¢–û–ü–µ –Ω–∞ –¥–æ–ª–≥–æ\n"
             "   –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ SEO\n"
             "‚ûñ –í—Ä–µ–º—è 4-6 –º–µ—Å—è—Ü–µ–≤")
    await query.message.answer_photo(photo=types.InputFile('media/seo_search.jpg'), caption=text)
    await query.message.answer_photo(photo=types.InputFile('media/seo_1.png'), caption=text2,
                                     reply_markup=main_page_button())


@dp.callback_query_handler(text='application')
async def seos_query_handler(query: types.CallbackQuery):
    await query.answer("–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–≤–æ–π –Ω–æ–º–µ—Ä")
    share_keyboard = types.ReplyKeyboardMarkup(resize_keyboard=True, one_time_keyboard=True)
    share_button = types.KeyboardButton(text="üì≤ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–æ–º–µ—Ä", request_contact=True)
    share_keyboard.add(share_button)
    await query.message.answer("–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–≤–æ–π –Ω–æ–º–µ—Ä –Ω–∞–∂–∏–º–∞—è –∫–Ω–æ–ø–∫—É —Å–Ω–∏–∑—Éüëá", reply_markup=share_keyboard)


@dp.callback_query_handler(text='contexts')
async def contexts_query_handler(query: types.CallbackQuery):
    await query.answer("–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞")
    text = ("–†–µ–∫–ª–∞–º–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ\n"
            "–¢–∞–∫–∞—è —Ä–µ–∫–ª–∞–º–∞ –ø—Ä–∏–≤–ª–µ–∫–∞–µ—Ç –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤. –ö–æ–Ω–≤–µ—Ä—Å–∏—è "
            "(–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤) –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—ã—Å–æ–∫–∞, –ø–æ—Ç–æ–º—É –∫–∞–∫ —ç—Ç–æ —Ü–µ–ª–µ–≤–∞—è —Ä–µ–∫–ª–∞–º–∞. "
            "–ï–µ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Ç–µ, –∫—Ç–æ –∏—â–µ—Ç –ø–æ–¥–æ–±–Ω—ã–µ –≤–∞—à–∏–º —É—Å–ª—É–≥–∏. –ù–∞–≤–µ—Ä–Ω—è–∫–∞ –≤—ã —É–∂–µ —Å—Ç–∞–ª–∫–∏–≤–∞–ª–∏—Å—å "
            "—Å —Ç–∞–∫–∏–º –ø–æ–Ω—è—Ç–∏–µ–º –∫–∞–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞.\n")
    text2 = ("–¢–∞–∫–æ–µ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ –∏–º–µ–µ—Ç –æ–≥—Ä–æ–º–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –¥—Ä—É–≥–∏–º–∏ "
             "—Ä–µ–∫–ª–∞–º–Ω—ã–º–∏ –∫–æ–º–ø–∞–Ω–∏—è–º–∏ ‚Äì —ç—Ç–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞. –ù–∏–∫–∞–∫–∏—Ö –ª–∏—à–Ω–∏—Ö –∑–∞—Ç—Ä–∞—Ç ‚Äì –ø–ª–∞—Ç–∞ —Ç–æ–ª—å–∫–æ –∑–∞ –∫–ª–∏–∫–∏. "
             "–ß–µ–º –≥—Ä–∞–º–æ—Ç–Ω–µ–µ –±—É–¥–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–∞–Ω–Ω—ã–π –≤–∏–¥ —Ä–µ–∫–ª–∞–º—ã, —Ç–µ–º –±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –æ–Ω–∞ –≤–∞–º –ø—Ä–∏–Ω–µ—Å–µ—Ç. "
             "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–π —Ä–µ–∫–ª–∞–º—ã ‚Äì –¥–µ–ª–æ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –Ω–∞–∏–±–æ–ª—å—à—É—é –æ—Ç–¥–∞—á—É, —Ç–æ –ª—É—á—à–µ "
             "–¥–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–æ–ª—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π —à–∞–≥ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—É. –ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –Ω–∞—à–∏–º –∫–ª–∏–µ–Ω—Ç–∞–º –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É—Å–ª—É–≥–∏ "
             "–ø–æ —Ä–∞–∑—É–º–Ω–æ–π —Ü–µ–Ω–µ. –î–æ–±–∏—Ç—å—Å—è –±–æ–ª—å—à–µ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞ –º–æ–∂–Ω–æ, –µ—Å–ª–∏ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å —Ç–∞–∫—É—é —Ä–µ–∫–ª–∞–º—É "
             "–Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–ª–æ—â–∞–¥–∫–∞—Ö.\n"
             "–†–µ–∫–ª–∞–º–∞ –≤ –≥—É–≥–ª–µ –ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–æ–ª—å—à–∏–º —Å–ø—Ä–æ—Å–æ–º. –ù–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –º–æ–º–µ–Ω—Ç "
             "Google ‚Äì —Å–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä —Å—Ä–µ–¥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞. "
             "–ù–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ª—é–±–æ–≥–æ —Å–∞–π—Ç–∞ –ø–µ—Å—Ç—Ä–∏—Ç —Ä–µ–∫–ª–∞–º–∞ –≥—É–≥–ª. –ù–µ —É–≤–∏–¥–µ—Ç—å –µ–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.\n"
             "–°—Ç–æ–∏–º–æ—Å—Ç—å —Ä–µ–∫–ª–∞–º—ã –Ω–∞ –¥–∞–Ω–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—ã—à–µ, —á–µ–º —Ä–µ–∫–ª–∞–º–∞ –≤ —è–Ω–¥–µ–∫—Å–µ, –Ω–æ –æ–Ω–æ —Ç–æ–≥–æ —Å—Ç–æ–∏—Ç. "
             "–î–ª—è –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ —è–Ω–¥–µ–∫—Å-—Ä–µ–∫–ª–∞–º–∞ ‚Äì —Ç–æ–∂–µ —Ö–æ—Ä–æ—à–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç. "
             "–í—ã –∏–∑–≤–µ—Å—Ç–∏—Ç–µ –æ —Å–µ–±–µ –æ–≥—Ä–æ–º–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—Ä–∞—É–∑–µ—Ä–∞ —è–Ω–¥–µ–∫—Å, "
             "–∞ —Ç–∞–∫–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ—á—Ç—ã yandex –∏ mail.\n"
             "–ù–∞–∏–±–æ–ª–µ–µ —è—Ä–∫–∞—è –∏ –∑–∞–ø–æ–º–∏–Ω–∞—é—â–∞—è—Å—è —Ä–µ–∫–ª–∞–º–∞ –Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ä–∞—Ö –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ ‚Äì –±–∞–Ω–Ω–µ—Ä–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞. "
             "–í—Å–µ–≥–¥–∞ —Ö–æ—á–µ—Ç—Å—è –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, —á—Ç–æ –∂–µ —Ç–∞–º –≤–Ω—É—Ç—Ä–∏, —É–≤–∏–¥–µ–≤ –∫—Ä–∞—Å–∏–≤—É—é –∫–∞—Ä—Ç–∏–Ω–∫—É. "
             "–•–æ—Ç–∏—Ç–µ –ø—Ä–∏–≤–ª–µ—á—å –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ –≤ —Å–≤–æ–π –±–∏–∑–Ω–µ—Å ‚Äì –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –Ω–∞–º, "
             "–∏ –º—ã —É–≤–µ–ª–∏—á–∏–º –≤–∞—à–∏ –¥–æ—Ö–æ–¥—ã, –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–≤ –ø—Ä–∏ —ç—Ç–æ–º —Ä–∞—Å—Ö–æ–¥—ã. –ñ–µ–ª–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ ‚Äì –Ω–∞—à–∞ –∑–∞–±–æ—Ç–∞.")
    await query.message.answer_photo(photo=types.InputFile('media/kontext.jpg'), caption=text)
    await query.message.answer(text2, reply_markup=main_page_button())


if __name__ == '__main__':
    executor.start_polling(dp, skip_updates=True)
